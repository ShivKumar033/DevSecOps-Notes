## Red-Team Mental Model

```
RoleID leak alone      â†’ low risk 
SecretID leak alone   â†’ low risk 
RoleID + SecretID     â†’ FULL ACCESS 
Bad policy            â†’ GAME OVER
```

### 1ï¸âƒ£ CI/CD Pipeline â†’ Vault Takeover

**Pattern**
```bash
CI logs / env vars leak
  â†’ ROLE_ID + SECRET_ID
  â†’ Vault token 
  â†’ Cloud / DB creds
```

**Common mistakes**

- AppRole creds in GitHub Actions / Jenkins logs
- Long-lived SecretIDs

---

### 2ï¸âƒ£ Over-Privileged AppRole = Full Vault Compromise

**Pattern**
```bash
Compromised app
  â†’ AppRole token
  â†’ wildcard policy (*)
  â†’ secrets list + token create
```

**Seen issues**
- `path "*"` policies
- AppRole allowed `auth/token/create`

---

### 3ï¸âƒ£ Leaked Root Token (Game Over)

**Pattern**
```bash
Root token in:
	- Terraform state
	- Bash history 
	- Slack paste 
â†’ Total Vault ownership
```
**Impact**
- Read/modify all secrets
- Disable audit logs
- Create backdoor tokens

---

### 4ï¸âƒ£ KV v2 â€œDeletedâ€ Secrets Still Recoverable

**Pattern**
```bash
vault kv delete 
	â‰  destroyed 
	â†’ attacker undeletes old secrets
```

**Seen issues**
- Old API keys
- Legacy prod passwords
- Forgotten DB creds

---

### 5ï¸âƒ£ Raft Snapshot / Backup Exposure

**Pattern**
```bash
Exposed raft snapshot 
	â†’ Offline Vault data access 
	â†’ Secret extraction / restore
```

**Where**
- S3 buckets
- Backup servers
- CI artifacts

---

## ğŸ§¾ Vault Attack Surface â€“ Ultra-Short Cheat Sheet

### ğŸ” Auth

- AppRole leaks
- Token auth abuse
- LDAP / OIDC misbind
- Kubernetes SA theft

---

### ğŸ”‘ Tokens

- Root token exposure    
- Long-lived tokens
- Orphan tokens
- Token reuse

---

### ğŸ“œ Policies

- Wildcards (`*`)    
- `sudo` capability
- Token creation perms
- Default policy misuse

---

### ğŸ—„ï¸ Secrets Engines

- KV v2 metadata    
- DB dynamic creds
- Cloud creds (AWS/GCP/Azure)
- PKI root CA
- Transit key misuse

---

### ğŸ”„ Lifecycle

- Soft delete â‰  destroy
- No rotation
- Old versions alive

---

### ğŸŒ Infra / Ops

- Vault UI exposed    
- TLS misconfig
- Audit logs off
- Terraform state leaks
- Raft snapshots

---

## ğŸ§  Red-Team Mental Model

```
Auth Leak
  â†’ Token
	 â†’ Policy Abuse
	    â†’ Secrets
	        â†’ Cloud / DB / Infra
```